# User Interface

The chatbot UI is built using the following technologies:

- **Framework**: _React_
- **Language**: _TypeScript_
- **Build Tool**: _Vite_

## Directory Structure (`/frontend`)

- `frontend/`
  - `src/`
    - `api/`: API utilities for backend communication
    - `components/`: React components
    - `data/`: Static text used in the UI
    - `model/`: TypeScript interfaces and types
    - `styles/`: Style definitions
    - `tests/`: Unit and Integration Tests for the frontend
    - `utils/`: Utilities functions
  - `dist/`: Build output generated by Vite (ignored in Git)
  - `vite.config.ts`: Vite configuration file
  - `package.json`: NPM metadata and scripts

## Setup and Use
> **Note**:  
> It is encouraged to use the latest**Node.js LTS** (project built with Node 24).  
> Ensure `npm` is available in your environment.

To build and run the frontend as part of the Jenkins plugin:

1. Navigate to the frontend directory:
    ```bash
    cd frontend
    ```

2. Install dependencies:
    ```bash
    npm install
    ```

3. Build the frontend and copy the output to Jenkins:
    ```bash
    npm run build
    ```

    This command builds the frontend using Vite and copies the compiled assets to:

    ```
    src/main/webapp/static/
    ```

4. Move back to the project root and start Jenkins:
    ```bash
    cd ..
    mvn hpi:run
    ```

## Using the Chatbot in Jenkins

Once Jenkins is running:

- Look for a ðŸ’¬ button in the **bottom-right corner**.
- Click it to toggle the chatbot panel.
- You can:
  - Type or paste questions (supports multiline)
  - Press `Enter` to send
  - Press `Shift + Enter` for a new line
  - Clear the conversation with the **"Clear chat"** button in the header
- Messages **persist on page refresh** (within the same session) but are **cleared when the tab or browser is closed**.

## UI Integration in Jenkins

To inject the React-based chatbot into the Jenkins interface, the plugin uses a `PageDecorator` extension along with a Jelly template. In this way the chatbot is injected globally across all pages in Jenkins.

### `ChatbotGlobalDecorator.java`

This java file is placed in:

```
src/main/java/io/jenkins/plugins/chatbot/ChatbotGlobalDecorator.java
```

The `ChatbotGlobalDecorator` is a Jenkins extension that allows injecting custom HTML or scripts into the global page layout.

This registers a decorator that looks for a corresponding Jelly template to render additional content on all pages.

### Jelly: `footer.jelly`

The Jelly file is placed in:

```
src/main/resources/io/jenkins/plugins/chatbot/ChatbotGlobalDecorator/footer.jelly
```

Its purpose is to inject the React root element and the compiled JavaScript bundle (built with Vite) into the page:

- `<div id="chatbot-root"></div>` serves as the mount point for the React application.
- The script loads the compiled JavaScript file from the plugin's static resources:
  ```
  src/main/webapp/static/assets/index.js
  ```
